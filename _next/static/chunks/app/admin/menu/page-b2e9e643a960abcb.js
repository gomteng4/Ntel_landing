(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[836],{617:(e,t,s)=>{Promise.resolve().then(s.bind(s,9046))},2099:(e,t,s)=>{"use strict";s.d(t,{N:()=>i});var a=s(5647),n=s(9509);let r=n.env.NEXT_PUBLIC_SUPABASE_URL||"https://suznpkxteqhvqvlaenrq.supabase.co",l=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1em5wa3h0ZXFodnF2bGFlbnJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzMzQ2NDYsImV4cCI6MjA2NjkxMDY0Nn0.hgGYLUWMoyjB4SpyEfR2nOqaAvPonaefyRZ6T3UYRO8",i=(0,a.UU)(r,l)},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},9046:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5155),n=s(2115),r=s(5695),l=s(6874),i=s.n(l),d=s(2099);function c(){let[e,t]=(0,n.useState)(!1),[s,l]=(0,n.useState)([]),[c,m]=(0,n.useState)(!0),[u,x]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null),b=(0,r.useRouter)();(0,n.useEffect)(()=>{"true"===localStorage.getItem("admin_auth")?(t(!0),g()):b.push("/admin")},[b]);let g=async()=>{try{let{data:e}=await d.N.from("menu_items").select("*").order("sort_order");e&&l(e)}catch(e){console.error("Error fetching menu items:",e)}finally{m(!1)}},f=async e=>{try{let{error:t}=await d.N.rpc("create_board_table",{table_name:e});return t&&console.log("Creating board table:",e),!0}catch(e){return console.error("Error creating board table:",e),!1}},y=async(e,t)=>{try{return"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { supabase } from '@/lib/supabase'\nimport Link from 'next/link'\n\ninterface BoardPost {\n  id: string\n  title: string\n  content: string\n  author: string\n  created_at: string\n  updated_at: string\n  is_active: boolean\n}\n\nexport default function ".concat(t.replace(/\s+/g,""),"Page() {\n  const [posts, setPosts] = useState<BoardPost[]>([])\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    fetchPosts()\n  }, [])\n\n  const fetchPosts = async () => {\n    try {\n      const { data } = await supabase\n        .from('").concat(e,'\')\n        .select(\'*\')\n        .eq(\'is_active\', true)\n        .order(\'created_at\', { ascending: false })\n      \n      if (data) setPosts(data)\n    } catch (error) {\n      console.error(\'Error fetching posts:\', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className="min-h-screen bg-gray-50 flex items-center justify-center">\n        <div className="text-center">\n          <h2 className="text-2xl font-bold text-gray-900 mb-4">로딩 중...</h2>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className="min-h-screen bg-gray-50">\n      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">\n        <div className="bg-white shadow rounded-lg">\n          <div className="px-6 py-4 border-b border-gray-200">\n            <h1 className="text-2xl font-bold text-gray-900">').concat(t,'</h1>\n          </div>\n          \n          <div className="divide-y divide-gray-200">\n            {posts.length === 0 ? (\n              <div className="p-8 text-center text-gray-500">\n                등록된 게시글이 없습니다.\n              </div>\n            ) : (\n              posts.map((post) => (\n                <div key={post.id} className="p-6 hover:bg-gray-50">\n                  <h3 className="text-lg font-medium text-gray-900 mb-2">{post.title}</h3>\n                  <p className="text-gray-600 mb-2">{post.content.substring(0, 100)}...</p>\n                  <div className="flex justify-between items-center text-sm text-gray-500">\n                    <span>작성자: {post.author}</span>\n                    <span>{new Date(post.created_at).toLocaleDateString()}</span>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}'),console.log("Board page content created for:",e),!0}catch(e){return console.error("Error creating board page:",e),!1}},N=async e=>{try{let t={...e};if("board"===e.menu_type&&e.title){let s="board_".concat(e.title.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""));t.board_table_name=s,t.url="/".concat(s),await f(s)||alert("게시판 테이블 생성에 실패했습니다. 수동으로 다음 SQL을 실행해주세요:\n\n"+"CREATE TABLE ".concat(s," (\n")+"  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,\n  title TEXT NOT NULL,\n  content TEXT,\n  author TEXT DEFAULT '관리자',\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,\n  is_active BOOLEAN DEFAULT true\n);"),await y(s,e.title)}if(e.id&&"new"!==e.id){let{id:s,created_at:a,updated_at:n,...r}=t,{error:l}=await d.N.from("menu_items").update(r).eq("id",e.id);if(l)throw l}else{let{id:e,created_at:s,updated_at:a,...n}=t,{error:r}=await d.N.from("menu_items").insert(n);if(r)throw r}await g(),x(!1),h(null),"board"===e.menu_type?alert('메뉴가 저장되었습니다!\n\n게시판 테이블 "'.concat(t.board_table_name,'"이 생성되었습니다.\n페이지는 수동으로 생성해주세요: src/app/').concat(t.board_table_name,"/page.tsx")):alert("메뉴가 저장되었습니다!")}catch(e){console.error("Error saving menu:",e),alert("저장 중 오류가 발생했습니다.")}},v=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{let{error:t}=await d.N.from("menu_items").delete().eq("id",e);if(t)throw t;await g(),alert("메뉴가 삭제되었습니다!")}catch(e){console.error("Error deleting menu:",e),alert("삭제 중 오류가 발생했습니다.")}},_={id:"new",title:"",url:"",sort_order:s.length+1,is_active:!0,has_dropdown:!1,menu_type:"link",board_table_name:"",created_at:"",updated_at:""};return!e||c?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"로딩 중..."})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i(),{href:"/admin/dashboard",className:"text-blue-600 hover:text-blue-800 mr-4",children:"← 대시보드"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"메뉴 관리"})]}),(0,a.jsx)("button",{onClick:()=>{h(_),x(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium",children:"새 메뉴 추가"})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[u&&p&&(0,a.jsx)(o,{menu:p,onSave:N,onCancel:()=>{x(!1),h(null)}}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"메뉴 목록"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:s.map(e=>(0,a.jsxs)("div",{className:"p-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:e.title}),(0,a.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["타입: ","link"===e.menu_type?"링크":"board"===e.menu_type?"게시판":"드롭다운"]}),e.url&&(0,a.jsxs)("span",{children:["URL: ",e.url]}),e.board_table_name&&(0,a.jsxs)("span",{children:["테이블: ",e.board_table_name]}),(0,a.jsxs)("span",{children:["순서: ",e.sort_order]}),(0,a.jsx)("span",{className:e.is_active?"text-green-600":"text-red-600",children:e.is_active?"활성":"비활성"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{h(e),x(!0)},className:"text-blue-600 hover:text-blue-800 px-3 py-1 text-sm",children:"편집"}),(0,a.jsx)("button",{onClick:()=>v(e.id),className:"text-red-600 hover:text-red-800 px-3 py-1 text-sm",children:"삭제"})]})]},e.id))})]})]})]})}function o(e){let{menu:t,onSave:s,onCancel:r}=e,[l,i]=(0,n.useState)(t);return(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg mb-6",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"new"===t.id?"새 메뉴 추가":"메뉴 편집"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(l)},className:"px-6 py-4 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"메뉴 제목"}),(0,a.jsx)("input",{type:"text",value:l.title,onChange:e=>i({...l,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"메뉴 타입"}),(0,a.jsxs)("select",{value:l.menu_type,onChange:e=>i({...l,menu_type:e.target.value,url:"board"===e.target.value?"":l.url}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"link",children:"링크"}),(0,a.jsx)("option",{value:"board",children:"게시판"}),(0,a.jsx)("option",{value:"dropdown",children:"드롭다운"})]})]})]}),"link"===l.menu_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL"}),(0,a.jsx)("input",{type:"url",value:l.url||"",onChange:e=>i({...l,url:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com",required:"link"===l.menu_type})]}),"board"===l.menu_type&&(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-blue-900 mb-2",children:"게시판 자동 생성"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"게시판 메뉴를 생성하면 자동으로 Supabase 테이블과 페이지가 생성됩니다."}),(0,a.jsxs)("ul",{className:"text-sm text-blue-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• 테이블명: board_",l.title.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")]}),(0,a.jsxs)("li",{children:["• URL: /",l.title.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")]}),(0,a.jsx)("li",{children:"• 기본 필드: id, title, content, author, created_at, updated_at, is_active"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"정렬 순서"}),(0,a.jsx)("input",{type:"number",value:l.sort_order,onChange:e=>i({...l,sort_order:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"상태"}),(0,a.jsxs)("select",{value:l.is_active?"true":"false",onChange:e=>i({...l,is_active:"true"===e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"true",children:"활성"}),(0,a.jsx)("option",{value:"false",children:"비활성"})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2 pt-8",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.has_dropdown,onChange:e=>i({...l,has_dropdown:e.target.checked}),className:"rounded",disabled:"dropdown"!==l.menu_type}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"드롭다운 메뉴"})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"취소"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"저장"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,647,441,303,358],()=>t(617)),_N_E=e.O()}]);